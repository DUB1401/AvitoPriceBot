# Avito Prcie Bot
**Avito Prcie Bot** – это бот [Telegram](https://telegram.org/) для сайта [Авито](https://www.avito.ru/), помогающий администрировать стоимость краткосрочно арендуемых помещений.

## Порядок установки и использования
1. Загрузить последний релиз. Распаковать.
2. Установить Python версии не старше 3.10.
3. В среду исполнения установить следующие пакеты: [dublib](https://github.com/DUB1401/dublib), [APScheduler](https://github.com/agronholm/apscheduler), [requests](https://github.com/psf/requests).
```
pip install git+https://github.com/DUB1401/dublib
pip install APScheduler
pip install requests
```
Либо установить сразу все пакеты при помощи следующей команды, выполненной из директории скрипта.
```
pip install -r requirements.txt
```
4. Настроить используемого бота путём добавления в него списка команд из файла _Commands.txt_.
5. Настроить скрипт путём редактирования _Settings.json_.
6. Открыть директорию со скриптом в терминале. Можно использовать метод `cd` и прописать путь к папке, либо запустить терминал из проводника.
7. Указать для выполнения главный файл скрипта `main.py`, перейти в Telegram, отправить в чат с ботом команду `/start` и следовать дальнейшим инструкциям.
8. Для автоматического запуска службы рекомендуется провести инициализацию скрипта через [systemd](https://github.com/systemd/systemd) (пример [здесь](https://github.com/DUB1401/AvitoPriceBot/tree/main/systemd)) на Linux или путём добавления его в автозагрузку на Windows.

# Основные команды
Под основными командами понимаются конструкции, которые сам бот Telegram интерпретирует как команды. Они всегда начинаются с символа косой черты.
___
```
/help
```
Выводит описание доступных команд.
___
```
/list
```
Выводит список подключённых профилей Авито.
___
```
/register
```
Запускает процедуру добавления нового профиля Авито.
___
```
/start
```
Инициализирует работу бота и запускает процесс авторизации.
___
```
/tasks
```
Выводит список запланированных задач.

# Функциональные команды
Под функциональными командами понимаются сообщения боту Telegram, имеющие особый синтаксис и порядок аргументов. Данные команды нечувствительны к регистру.
___
```
deltask [TASK_ID]
```
Удаляет задачу.
___
```
newtask [ACCOUNT] [ITEM_ID] [PRICE] [DAY] [HOUR] [MINUTE]
```
Создаёт задачу с отложенным или регулярным выполнением.
___
```
price [ACCOUNT] [ITEM_ID] [PRICE]
```
Моментально задаёт новую стоимость.
___
```
rename [OLD_ACCOUNT] [NEW_ACCOUNT]
```
Изменяет идентификатор пользователя.
___
```
unregister [ACCOUNT]
```
Удаляет профиль и связанные с ним задачи.

> [!WARNING]  
> Задачи, в которых используется удаляемый профиль, будут также удалены. 

# Settings.json
```JSON
"token": ""
```
Сюда необходимо занести токен бота Telegram (можно получить у [BotFather](https://t.me/BotFather)).
___
```JSON
"bot-password": "1234"
```
Пароль для доступа к боту.
___
```JSON
"timezone": "Europe/Moscow"
```
Указывает часовой пояс для планировщика задач.
___
```JSON
"use-supervisor": true
```
Если включено, то для каждого добавленного профиля Авито будет создан поток-надзиратель, следящий за стабильным обновлением токенов доступа. Повышает стабильность работы скрипта.
___
```JSON
"recycling-id": true
```
Переключает режим генерации ID новых задач. Если отключить, ID будут постоянно увеличиваться, игнорируя освободившиеся номера.
___
```JSON
"delay": 1
```
Задаёт интервал в секундах между последовательными запросами к API Авито.

_Copyright © DUB1401. 2023._
